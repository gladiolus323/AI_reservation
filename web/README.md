# 검사 예약 시간표 웹 뷰어

## 개요

병원 검사 예약 데이터를 시각화하는 HTML 기반 뷰어입니다.
`schedule_viewer.html` 파일을 브라우저에서 열어 사용합니다.

---

## 주요 기능

### 1. 뷰 모드
- **일간 뷰**: 선택한 날짜의 모든 장비/자원을 가로로 한 화면에 표시
- **주간 뷰**: 선택한 날짜 기준 월~일 7일간의 예약을 장비별로 표시

### 2. 날짜 선택
- 달력 형태의 date picker 사용
- **4개의 날짜 이동 버튼**: 1주 전, 1일 전, 1일 후, 1주 후
- 주간 뷰에서 날짜 헤더 클릭 시 해당 날짜 선택 (일간 뷰 전환 시 해당 날짜로 이동)

### 3. 장비 필터
- 상단 드롭다운에서 전체 또는 특정 장비 유형 선택
- **일간 뷰에서 장비 헤더 클릭 시 해당 장비만 필터링** (CT, MRI 등 클릭)

### 4. 시간표 UI
- **10분 단위 그리드** (일간), **30분 단위 그리드** (주간)
- **시간 셀 병합**: 1시간 단위로 병합하여 중앙 정렬
- **시간 구분선**: 정각 경계에 진한 선으로 구분
- **장비 구분선**: 장비 유형별 왼쪽 경계에 진한 선으로 구분
- **장비 유형 헤더**: 색상으로 구분된 장비 유형 표시 (예약 건수 포함)

### 5. 예약 블록 & Hover 정보
- 장비별 고유 색상으로 표시
- **마우스 hover 시 정보 박스 표시** (마우스 위치를 따라다님):
  - 검사명
  - 검사 코드
  - 자원 ID (예: CT_01)
  - 환자 ID
  - 예약 시간 및 소요 시간

---

## 장비별 색상

| 장비 | 색상 | HEX |
|------|------|-----|
| CT | 초록 | #4CAF50 |
| MRI | 파랑 | #2196F3 |
| US | 주황 | #FF9800 |
| NM | 보라 | #9C27B0 |
| ENDO | 분홍 | #E91E63 |
| FUNC | 청록 | #00BCD4 |
| XRAY | 갈색 | #795548 |
| FLUORO | 회색 | #607D8B |

---

## 파일 구조

```
web/
├── schedule_viewer.html   # 메인 뷰어 (단일 HTML, 외부 의존성 없음)
└── README.md              # 이 문서

src/
└── generate_schedule_html.py  # HTML 생성 스크립트
```

---

## HTML 재생성 방법

데이터가 변경되거나 UI를 수정한 경우:

```bash
# PowerShell (Windows)
& 'C:\Miniconda3\python.exe' 'c:\Users\user\Desktop\검사규칙 합성데이터\src\generate_schedule_html.py'

# 또는 일반 Python
python src/generate_schedule_html.py
```

출력 경로: `web/schedule_viewer.html`

---

## 데이터 소스

- **RESERVATION.csv**: 예약 데이터 (12,063건)
- **RESOURCE.csv**: 자원 마스터 (36대)
  - CT: 4대, MRI: 5대, US: 4대, NM: 4대
  - ENDO: 5대, FUNC: 8대, XRAY: 3대, FLUORO: 3대

---

## 구현 히스토리

### v1.0 (초기)
- 기본 시간표 뷰어 구현
- 장비별 세로 스크롤 방식

### v2.0 (레이아웃 개선)
- 일간 뷰: 모든 장비를 가로로 한 화면에 표시
- 표 형태 CSS Grid 레이아웃 적용

### v3.0 (UI 개선)
- 시간 셀 병합 (1시간 단위) 및 중앙 정렬
- 정각 경계에 진한 구분선 추가
- 장비 유형별 색상 헤더 및 구분선

### v4.0 (날짜 선택 개선)
- 드롭다운 → 달력 형태 date picker 변경
- 주간 뷰에서 날짜 클릭 시 해당 날짜 선택 기능

### v5.0 (인터랙션 개선)
- 일간 뷰에서 장비 헤더 클릭 시 해당 장비만 필터링
- 마우스 hover 시 정보 박스 표시 (마우스 위치 추적)
- 불필요한 CSS 코드 정리

### v6.0 (날짜 네비게이션 개선)
- 2개 버튼(이전/다음) → 4개 고정 버튼으로 변경
- 1주 전, 1일 전, 1일 후, 1주 후 독립 버튼
- 뷰 모드와 무관하게 일관된 날짜 이동

### v7.0 (스크롤 및 레이아웃 개선)
- 시간 열 고정 (sticky): 가로 스크롤 시 시간 열이 왼쪽에 고정
- 그리드 영역만 스크롤: 흰색 패딩 영역은 고정, 내부 그리드만 스크롤
- 예약 없는 장비도 표시: 해당 날짜에 예약이 없어도 모든 장비 유형 표시
- 불필요한 CSS/JS 코드 정리

---

## 사용법 요약

| 동작 | 설명 |
|------|------|
| 날짜 선택 | 달력 아이콘 클릭하여 날짜 선택 |
| 날짜 이동 | `◀◀ 1주 전` `◀ 1일 전` `1일 후 ▶` `1주 후 ▶▶` 버튼 클릭 |
| 뷰 전환 | 일간/주간 버튼 클릭 |
| 장비 필터 (드롭다운) | 상단 장비 드롭다운에서 선택 |
| 장비 필터 (클릭) | 일간 뷰에서 장비 헤더 클릭 |
| 날짜 선택 (주간) | 주간 뷰에서 날짜 헤더 클릭 |
| 예약 정보 보기 | 예약 블록에 마우스 hover |

---

## 브라우저 호환성

- Chrome, Edge, Firefox 등 최신 브라우저 지원
- CSS Grid, Flexbox 사용
- 외부 라이브러리 없음 (순수 HTML/CSS/JS)

---

## 향후 개선 가능 사항

1. 월간 뷰 추가
2. 검색 기능 (환자 ID, 검사 코드)
3. 예약 통계 대시보드
4. 인쇄 최적화 스타일
5. 다크 모드 지원

---

*최종 업데이트: 2025-12-23*
